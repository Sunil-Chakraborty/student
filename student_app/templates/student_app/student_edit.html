{% extends 'base.html' %}

{% block content %}
<header>
		<script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
</header>

<h1>Course data edit</h1>

<form method="POST">
    {% csrf_token %}
    

    <table>
        <thead>
            <tr>
				<th>Row&nbsp&nbsp</th>				
                <th>Course Name</th>
                <th>Session</th>
                <th>Semester</th>
                <th>Schd-HC</th>
                <th>Actl-HC</th>
				<th>Delete</th>
            </tr>
        </thead>
        <tbody>
			<!--{{formset}}-->
			{{ formset.management_form }}
			{% for form in formset %}
			
			{% if form.errors %}
				<div class="alert alert-danger">
				<p><strong>Error in</strong>
					Row {{ forloop.counter }}:
				</p>
					<ul>
						{% for field_errors in form.errors.values %}
							{% for error in field_errors %}
								<li>{{ error }}</li>							
							{% endfor %}
						{% endfor %}
					</ul>
				</div>
			{% endif %}
			
                <tr>
					<td style="text-align:center;">{{ forloop.counter }}</td>
                    <td>{{ form.course_name }}</td>
                    <td>{{ form.session }}</td>
                    <td>{{ form.semister }}</td>
                    <td>{{ form.sch_hc }}</td>
                    <td>{{ form.act_hc }}</td>
					<td>{{ form.DELETE}}</td>
                </tr>
				{{ form.id }}
            {% endfor %}
        </tbody>
    </table>
    <button type="submit">Save</button>
</form>
<script>
$(document).ready(function() {
    $('.skip-enter').keydown(function(event) {
        var td = $(this).closest('td');
        var tr = $(this).closest('tr');
        var idx = td.index();
        
        if (event.keyCode === 13) { // Enter key code is 13
            event.preventDefault();
            var inputs = $(this).find(':input');
            var currentInput = inputs.get(0);
            
            if (currentInput !== null) {
                var inputsInRow = tr.find('td').eq(idx).find(':input');
                var inputIdx = inputsInRow.index(currentInput);
                
                if (inputIdx !== -1 && inputIdx < inputsInRow.length - 1) {
                    var nextInput = inputsInRow.eq(inputIdx + 1);
                    nextInput.focus();
                } else {
                    var nextTd = td.next();
                    var nextInputs = nextTd.find(':input');
                    if (nextInputs.length > 0) {
                        nextInputs.eq(0).focus();
                    }
                }
            }
        } else if (event.keyCode === 38) { // Up arrow key code is 38
            event.preventDefault();
            var prevTd = td.prev();
            if (prevTd.length > 0) {
                var prevInputs = prevTd.find(':input');
                if (prevInputs.length > 0) {
                    var lastInput = prevInputs.last();
                    lastInput.focus();
                }
            }
        } else if (event.keyCode === 40) { // Down arrow key code is 40
            event.preventDefault();
            var nextTd = td.next();
            if (nextTd.length > 0) {
                var nextInputs = nextTd.find(':input');
                if (nextInputs.length > 0) {
                    var firstInput = nextInputs.eq(0);
                    firstInput.focus();
                }
            }
        }
    });
});
</script>

{% endblock %}

<!--
{% for form in formset.forms %}
    {% for field in form %}
        {{ field.label }}: {{ field }}<br>
    {% endfor %}
{% endfor %} -->


