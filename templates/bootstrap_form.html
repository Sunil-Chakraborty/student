{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <title>Filter Form</title>
	<link rel="stylesheet" href="{% static 'template.css' %}">
	
	 
	<script type="text/javascript" src="//code.jquery.com/jquery-3.5.1.js"></script> 
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">  
	<script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>  
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>  
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css">  
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
	
	<!-- Data Table in Jquery -->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
	<script type="text/javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>  
	<script type="text/javascript" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>  
	
	<!-- Data Table export in Jquery -->
	<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
	<script type="text/javascript" src="//cdn.datatables.net/plug-ins/1.11.5/api/sum().js"></script>
	<script type="text/javascript" src="//cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
	<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
	<script type="text/javascript" src="//cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
	<script type="text/javascript" src="//cdn.datatables.net/buttons/2.3.6/js/buttons.print.min.js"></script>
	
	<style type="text/css">
		.container{
			margin-top: 5px;
			margin-left: 100px;
			font-size:20px;

		}
		.card-body{
			background-color: #5d5c61;
			cursor:default;
			overflow: auto;
    		white-space: nowrap;
		} 
		.card {
		   background-color: 1FCBDE;
		   color: #fff;
		   padding: 15px 30px;
		   border-radius: 3px;
		   
		   margin-bottom: 5px; 
		}
		
		thead.sticky {
		  position: -webkit-sticky;
		  position: sticky;
		  top: 0;
		  background-color: #5d5c61;		  
		  padding: 50px;
		  font-size: 20px;
		  height : 40px;
		  
		}
		.div_class{
			font-size:25px;
			font-weight:bolder;
			
		}
		.multiselect-selected{
			width:250px;
			font-size:10px;
		}
		
		.myFont{
			font-size:15px;
			font-weight:bold;
		}
		.multiselect-wrapper {
			font-size:15px;
			font-weight:bold;
		}
		.dataTables_wrapper .dataTables_paginate .paginate_button {
			border-radius: 0;
			background: powderblue;
			
		}
		.dataTables_length {		
			color: black !important;
			margin-right:200px !important;;
		}
		.dataTables_filter {
			color:black !important;
		}
		.dt-buttons{
			color:black !important;
		}
		

	</style>
  </head>

  <body>
   
	<br>
    <main role="main" class="container" style="width:100%;">

      <h3 style="margin-left:15px;font-size:30px;font-weight:bold;">Filter Students Matrix</h3>
	  <hr/>
      <form method="GET" action="">
		
        <div class="form-row " style="margin-left:15px;"> 
          
            <label for="year" style="margin-right:5px;">Year</label>
            <select id="year-checkboxes" class="year" name="year" multiple >
              {% for yr in fin_yr %}
					<option  value="{{ yr }}">{{ yr }}</option>
              {% endfor %}
            </select>
			<br />
			<input type="button" id="select_yr" name="select_all" value="Select All">
		  
            <label for="course" style="margin-left:5px;margin-right:5px;">Course</label>
            <select id="course-checkboxes"  name="course" multiple>
              {% for course in courses %}
					<option value="{{ course }}">{{ course }}</option>
              {% endfor %}
            </select>
			<br />
			<input type="button" id="select_course" name="select_all" value="Select All">

		  
            <label for="faculty">&nbspFaculty</label>
            <select id="faculty-checkboxes"  name="faculty" multiple>
              {% for faculty in faculty %}
					<option value="{{ faculty }}">{{ faculty }}</option>
              {% endfor %}
            </select>
			<br />
			<input type="button" id="select_faculty" name="select_all" value="Select All">

          
        </div>
		</hr>
		<br>
        <div class="row div_class" >
			<button id="srch" type="submit" style="font-size:20px;font-weight:bolder;margin-left:25px;"  class="btn btn-primary">Search</button>
		</div>
	  </form>

      
	  <br>
	  <br>
	  
	  <p>Total intake :&nbsp {{qs_sum_intake}}</p>
	  
	  <p>Total strength :&nbsp {{qs_sum_strength}}</p>
	  <br>
	  <br>
	  <hr />
	  
	  <div class="card shadow p-3 mb-5 bg-white rounded" style="max-width:100%;margin-top:5px;">
     
		<table id="student" class = "table sts table-striped rounded shadow display" style="width:100% ">
				
				<h2 style="color:green;font-weight:bolder;font-size:30px;text-align:center">Student History Data</h2>
				<thead class="sticky">
					<tr>
						<th style="text-align: left;color:white; width:3%">Srl.</th>
						<th style="text-align: left;color:white; width:10%">Year</th>	
						<th style="text-align: left;color:white; width:50%">Course Name</th>						
						<th style="text-align: left;color:white; width:10%">Faculty</th>
						<th style="text-align: left;color:white; width:9%">Courses</th>
						<th style="text-align: left;color:white; width:9%">Intake</th>
						<th style="text-align: left;color:white; width:9%">Strength</th>
					</tr>
				</thead>
				{% for student in queryset %}
					<tr>
						<td>{{ forloop.counter }}</td>
						<td>{{ student.year }}</td>
						<td>{{ student.course_name }}</td>
						<td>{{ student.faculty }}</td>
						<td>{{ student.courses }}</td>						
						<td style="text-align: right;">{{ student.intake|floatformat:2 }}</td>						
						<td style="text-align: right;">{{ student.strength|floatformat:2 }}</td>						
					</tr>				
				{% endfor %}
				<tfoot>
					<tr>
						<th></th>
						<th></th>
						<th></th>
						<th></th>
						<th style="text-align: right;"></th>
						<th style="text-align: right;"></th>
						<th style="text-align: right;"></th>						
					</tr>
				</tfoot>
		</table>
				
	</div>		

    </main>




<script type="text/javascript">

	
  $(document).ready(function() {
  
	$('#select_yr').click(function() {
		$('#year-checkboxes option').prop('selected', true);
	});
	
	$('#select_course').click(function() {
		$('#course-checkboxes option').prop('selected', true);
	});
	
	$('#select_faculty').click(function() {
		$('#faculty-checkboxes option').prop('selected', true);
	});
	
	$('#student').DataTable({
	
			drawCallback: function () {
		      var api = this.api();
		      var sum = 0;
		      var formated = 0;
		      //to show first th
		      $(api.column(4).footer()).html('Total:');

		      for(var i=5; i<=6;i++)
		      {
		      	sum = api.column(i, {page:'current'}).data().sum();
				
		      	//to format this sum
		      	formated = parseFloat(sum).toLocaleString(undefined, {minimumFractionDigits:2});
		      	$(api.column(i).footer()).html(formated);
				
		      }
		      
		    },
			
			dom: 'lBfrtip',
			
			columnDefs: [
				{
					targets: [0],
					orderData: [0, 1],
				},
				{
					targets: [1],
					orderData: [1, 0],
				},
				{
					targets: [4],
					orderData: [4, 0],
				},
			],
			
			buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
			]
			
			
	});
	
	
  });
  

</script>

</body>

</html>
